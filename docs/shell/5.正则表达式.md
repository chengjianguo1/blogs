# 5.正则表达式

- [regexper](https://regexper.com/)

## 5.1 概念

- 正则表达式是用于描述字符排列和匹配模式的一种语法规则
- 它主要用于字符串的模式分割、匹配查找及替换操作

## 5.2 通配符

- 通配符用来匹配符合条件的文件名，通配符是完全匹配。
- ls find 这些命令不支持正则，只能使用通配符

| 符号 | 含义                         |
| ---- | ---------------------------- |
| ?    | 匹配任意一个字符             |
| \*   | 匹配任意多个字符             |
| []   | 匹配中括号中范围内的一个字符 |

## 5.3 正则表达式

- 正则表达式是用来在文件中匹配符合条件的字符串，是包含匹配。
- grep awk sed 等都可以支持正则表达式

## 5.5 元字符

`alias grep='grep --color=auto'`

| 元字符 | 作用                                                                                                                                                         | 示例                  |
| ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------- |
| \*     | 前一个字符匹配 0 次或任意多次                                                                                                                                | grep 1\* reg.txt      |
| .      | 匹配除换行符外的任意一个字符                                                                                                                                 | grep . reg.txt        |
| ^      | 匹配行首。例如，^hello 会匹配以 hello 开头的行                                                                                                               | grep ^a reg.txt       |
| \$     | 匹配行尾。例如，hello& 会匹配以 hello 结尾的行                                                                                                               | grep a\$ reg.txt      |
| []     | 匹配屮柄号屮指定的任意一个字符，而且只匹配一个字符。例如.[aoeiu]匹配任意一个元音字母,[0-9] 匹配任意一位数字,[a-z][0-9]匹配由小写字母和一位数字构成的两位字符 | grep ab[bc]c reg.txt  |
| [^]    | 匹配除中括号中的字符以外的任意一个字符。例如，[^0-9] 匹配任意一位非数字字符,[^a-z] 匹配任意一位非小写字母                                                    | grep a[^fg]c reg.txt  |
| \\     | 转义符，用于取消特殊符号的含义                                                                                                                               | grep \\.\$ reg.txt    |
| {n}    | 表示其前面的字符恰好出现 n 次。例如，[0-9]{5} 匹配 5 位数字，[1][3-8][0-9]{9} 匹配手机号码                                                                   | grep "a{1}" reg.txt   |
| {n,}   | 表示其前面的字符出现不少于 n 次。例如，[0-9]{2,} 匹配两位及以上的数字                                                                                        | grep "a{1,}" reg.txt  |
| {n,m}  | 表示其前面的字符至少出现 n 次，最多出现 m 次。例如，[a-z]{6,8} 匹配 6〜8 位的小写字母                                                                        | grep "a{2,3}" reg.txt |

## 5.5 cut

- cut 用来提取文本中的某一部分文本
- cut [选项] 文件名
  - -f 列号，用来指定要提取的列
  - -d 分隔符，按照指定分隔符分割列,默认分隔符是 TAB 制表符

```
at /etc/passwd | grep /bin/bash | cut -f 1,2 -d :

df -h | grep /dev/sda5 | cut -f 5
```

## 5.6 printf

- 按规定格式输出
- printf 输出类型 输出内容

| 参数  | 含义                                                                                                |
| ----- | --------------------------------------------------------------------------------------------------- |
| %ns   | 输出字符串,n 是数字指代输出几个字符                                                                 |
| %ni   | 输出整数,n 是指输出几个数字                                                                         |
| %m.nf | 输出浮点数,m 和 n 是数字，指代输出的整数位数和小数位数，如%6.2f 代表输出 6 位位，2 位小数，5 位整数 |

```
printf "%s\t%s\t%s\t%s\t%s\t\%s\n" $(df -h | grep /dev/sda5) | cut -f 5
```

## 5.7 awk(1-8)

- awk '条件 1{动作 1} 条件 2{动作 2}...' 文件名
- 条件(Pattern)
  - 一般使用关系表达式作为条件
  - x > 10 判断变量 x 是否大于 10
  - x >=10 大于等于
  - x <=10 小于等于
- 动作(Action)
  - 格式化输出
- $0 整行 $1 第一列...

```
 df -h | grep /dev/sda5 |awk '{print $5}'| cut -d '%' -f 1
```

## 5.7.1 begin end

- awk 可以正确截取制表符和空格
- begin 在所有的输出之前打印
- end 在所有的输出之后打印

```
awk 'BEGIN{print "开始"}END{print "结束"}' numbers.txt
```

## 5.7.2 FS

- Field Separator，字段分隔符

```
awk 'BEGIN{FS=":"}{print $1"\t"$2}' /etc/passwd
```

## 5.7.3 声明变量

```
awk 'BEGIN{sum=0}{sum=sum+$1}END{print sum}' numbers.txt
```

## 5.7.5 多条件

```
awk '$2>90{print $1"\t优秀"}$2>80{print $2"\t良好"}' score.txt
```

## 5.7.5 NR

- NR,表示 awk 开始执行程序后所读取的数据行数

```
awk '{print NR,$0}' file1
awk 'NR=3{print $0}' file1
```

## 5.7.6 OFS

- OFS Out of Field Separator，输出字段分隔符

```
echo "i love you" | awk 'BEGIN{ FS=" ";OFS="-" }{ print $1,$2,$3}'
```

### 5.8 sed 命令

- sed 是一个轻量级编辑器，主要用来对数据进行选取、替换、替换和新增操作
- sed [选项] '[动作]' 文件名
- 所有的动作都必须用单号号括起来
- 类型类似于批量 vi 操作

选项

||||
|--|--|--|
||||
||||
