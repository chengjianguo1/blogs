# 2.变量

## 2.1 什么是变量

- 可以变化的量
- 变量必须以字母或下划线开头，名字中间只能由字母，数字和下划线组成
- 变量名的长度不得超过 255 个字符
- 变量名在有效范围内必须唯一
- 变量默认类型都是字符串

## 2.2 变量的分类

- 字符串
- 整型
- 浮点型
- 日期型

## 2.3 用户自定义变量 (1-6)

- 这些变量的值是自己定义的
- 变量名不能为数字开头
- 等号左右两边不能有空格

## 2.3.1 定义变量

```
name="zhufeng"
age=10
```

## 2.3.2 输出变量值

```
echo $变量名
```

## 2.3.3 值默认都是字符串

```
$ x=1
$ y=2
$ z=3
$ z=$x+$y+$z
$ echo $z
```

## 2.3.4 在赋值的时候引用变量

```
y="$y"2
y=${y}2
```

## 2.3.5 set

- 查询系统中默认所有已经生效的变量，包括系统变量,也包括自定义变量

```
set | grep zhufeng
```

```
$ set -u
$ echo $a
bash: a: unbound variable
```

## 2.3.6 unset

- 删除变量

```
unset a
```

## 2.4 环境变量 (1-7)

- 环境变量是全局变量，而自定义变量是局部变量
- 自定义变量会在当前的 shell 中生效，而环境变量会在当前 shell 以及其子 shell 中生效
- 这种变量主要保存的是和系统操作环境相关的数据
- 变量可以自定义，但是对系统生效的环境变量名和变量作用是固定的

```
bash
pstree
```

## 2.4.1 自定义环境变量

```
export 变量名=变量值
export envname=prod
```

## 2.4.2 env

- 仅仅用来查看环境变量，而不看到本地变量

```
env
```

## 2.4.3 常用环境变量

| 变量名     | 含义                                                   | 示例                              |
| ---------- | ------------------------------------------------------ | --------------------------------- |
| HOSTNAME   | 主机名                                                 | HOSTNAME=localhost                |
| SHELL      | 当前的 shell                                           | SHELL=/bin/bash                   |
| TERM       | 终端环境                                               | TERM=xterm                        |
| HISTSIZE   | 历史命令条数                                           | HISTSIZE=1000                     |
| SSH_CLIENT | 当前操作环境如果是用 SSH 连接的话，这里会记录客户端 IP | SSH_CLIENT=192.168.1.100 57596 22 |
| SSH_TTY    | SSH 连接的终端                                         | SSH_TTY=/dev/pts/1                |
| USER       | 当前登录的用户                                         | USER=root                         |

## 2.4.4 path

- 系统搜索路径

```
# echo $PATH
/usr/lib/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
```

如果想把一个自定义的脚本直接可以执行，或者把这个文件拷贝到目标目录下，或者把脚本所在目录添加到环境变量中的 PATH 路径中
<br/>

hello.sh

```
#!/bin/bash
echo hello
```

```
./hello.sh
/root/myshell/hello.sh
export PATH="$PATH":/root/myshell   临时生效
hello.sh
```

## 2.4.5 \$PS1

```
# echo $PS1
[\u@\h \W]\$
root@localhost myshell]#
```

| 变量 | 提示符                          |
| ---- | ------------------------------- |
| \d   | 显示日期，格式为"星期 月 日"    |
| \H   | 完整的主机名                    |
| \t   | 24 小时制时间,格式为 "HH:MM:SS" |
| \A   | 24 小时制时间，格式为 "HH:MM"   |
| \u   | 显示当前用户名                  |
| \w   | 显示所在目录完整名称            |
| \W   | 显示所在目录的最后一个目录      |
| \$   | 提示符，root 为#,普通用户为\$   |

```
export PS1='[\u@\h \w]\$ '
```

## 2.4.6 语系环境变量

- 查询当前系统语系
- 在 Linux 中通过 locale 来设置程序运行的不同语言环境，locale 由 ANSI C 提供支持。locale 的命名规则为<语言>\_<地区>.<字符集编码>，如 zh_CN.UTF-8，zh 代表中文，CN 代表大陆地区，UTF-8 表示字符集。
- LANG: 定义系统主语系的变量

```
locale
LANG=zh_CN.UTF-8

echo $LANG

下次开机之后我们系统环境
cat /etc/sysconfig/i18n
```

## 2.4.7 中文支持

- 图形界面可以支持中文
- 第三方工具比如 xshell 语系设置正确可以支持中文
- 虚拟机中的纯字符界面不支持中文

## 2.5 位置参数变量

- 这种变量主要是用来向脚本当中传递参数或数据的,变量名不能自定义,变量作用是固定的

|位置参数变量|作用|
|$n|n为数字，$0 代表命令本身，$1-$9 代表第 1 到第 9 个参数，10 以上的参数需要用大括号包含,如${10}|
|$*|这个变量代表命令中所有的参数，\$*把所有的变看数看成一个整体|
|$@|这个变量也代表命令行中所有的参数，不过$@把每个参数进行区分|
|\$#|这个变量代表命令行中所有参数的个数|

```
#!/bin/bash
num1=$1
num2=$2
sum=$((num1+num2))
echo $sum
```

```
#!/bin/bash
for i in "$@"
 do
   echo "i=$i"
 done
```

## 2.6 预定义变量

- 是脚本中已经定义好的变量，变量名不能自定义，变量作用也是固定的

|位置参数变量|作用|
|$?|最后一次执行的命令的返回状态。0表示正确执行，非0表示不正确执行|
|$$|当前进程的进程号(PID)|
|$!|后台运行的最后一个进程号(PID)|

```
ls && echo yes
```

## 2.7 read

read [选项][变量名]

| 选项 | 含义                                                          |
| ---- | ------------------------------------------------------------- |
| -p   | 提示信息，在等待 read 输入时，输出提示信息                    |
| -t   | 秒数: read 命令会一直等待用户输入，使用此选项可以指定等待时间 |
| -n   | 字符数，read 命令只接受指定的字符数，就会执行                 |
| -s   | 隐藏输入的数据，适用于机密信息的输入                          |

```
#!/bin/bash
read -p 'please input your name:' -t 5 name
echo -e "\n"
read -p 'please input you gender[m/f]:' -n 1 gender
echo -e "\n"
read -p 'please input your password:' -s password
echo -e "\n"
echo $name,$gender,$password
```
